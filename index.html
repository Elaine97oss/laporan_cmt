<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan Siaga Demonstrasi dan Huru Hara</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .form-container {
            padding: 40px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .form-group {
            position: relative;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.95em;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .escalation-group {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 10px;
        }

        .escalation-option {
            position: relative;
        }

        .escalation-option input[type="radio"] {
            display: none;
        }

        .escalation-label {
            display: block;
            padding: 15px;
            text-align: center;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .escalation-option input[type="radio"]:checked + .escalation-label.green {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }

        .escalation-option input[type="radio"]:checked + .escalation-label.yellow {
            background: #fff3cd;
            border-color: #ffc107;
            color: #856404;
        }

        .escalation-option input[type="radio"]:checked + .escalation-label.red {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }

        .photo-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e1e8ed;
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .photo-upload {
            border: 2px dashed #667eea;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(45deg, #f8f9ff, #fff);
            min-height: 280px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            -webkit-tap-highlight-color: rgba(102, 126, 234, 0.2);
            touch-action: manipulation;
        }

        .photo-upload:hover {
            border-color: #764ba2;
            background: linear-gradient(45deg, #f0f2ff, #fff);
        }

        .photo-upload.has-image {
            padding: 15px;
            border-style: solid;
            border-color: #28a745;
            background: #f8fff9;
        }

        .photo-upload input {
            display: none;
        }

        .photo-preview-container {
            width: 100%;
            height: 200px;
            position: relative;
            overflow: hidden;
            border-radius: 10px;
            background: #f8f9fa;
            display: none;
        }

        .photo-upload.has-image .photo-preview-container {
            display: block;
        }

        .photo-preview {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            cursor: pointer;
        }

        .photo-controls {
            display: none;
            position: absolute;
            top: 10px;
            right: 10px;
            gap: 5px;
        }

        .photo-upload.has-image .photo-controls {
            display: flex;
        }

        .control-btn {
            background: rgba(0,0,0,0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: background 0.3s ease;
        }

        .control-btn:hover {
            background: rgba(0,0,0,0.9);
        }

        .upload-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .photo-upload.has-image .upload-content {
            display: none;
        }

        .upload-icon {
            font-size: 3em;
            color: #667eea;
            margin-bottom: 15px;
        }

        .photo-label {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
            text-align: center;
        }

        .submit-section {
            margin-top: 40px;
            text-align: center;
            padding-top: 30px;
            border-top: 2px solid #e1e8ed;
        }

        .btn-group {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(40, 167, 69, 0.3);
        }

        .report-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .meta-item {
            text-align: center;
        }

        .meta-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }

        .meta-label {
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }

        @media print {
            @page {
                size: A4;
                margin: 15mm;
            }
            
            body { 
                background: white !important; 
                padding: 0;
                font-size: 12px !important;
                line-height: 1.4 !important;
            }
            
            .container { 
                box-shadow: none; 
                border-radius: 0;
                max-width: none !important;
            }
            
            .header {
                background: #333 !important;
                padding: 20px !important;
                margin-bottom: 20px !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .header h1 {
                font-size: 2em !important;
                margin-bottom: 8px !important;
            }
            
            .header p {
                font-size: 1.1em !important;
            }
            
            .form-container {
                padding: 0 !important;
            }
            
            .report-meta {
                padding: 15px !important;
                margin-bottom: 20px !important;
                page-break-inside: avoid;
                display: grid !important;
                grid-template-columns: 1fr 1fr !important;
                gap: 20px !important;
            }
            
            .meta-value {
                font-size: 1.4em !important;
            }
            
            .meta-label {
                font-size: 0.9em !important;
            }
            
            .form-grid {
                display: grid !important;
                grid-template-columns: 1fr 1fr !important;
                gap: 15px 20px !important;
                margin-bottom: 20px !important;
            }
            
            .form-group {
                margin-bottom: 12px !important;
            }
            
            .form-group.full-width {
                grid-column: 1 / -1 !important;
            }
            
            label {
                font-size: 11px !important;
                font-weight: bold !important;
                margin-bottom: 6px !important;
                display: block !important;
            }
            
            input, select, textarea {
                padding: 6px 8px !important;
                font-size: 11px !important;
                border: 1px solid #ccc !important;
                border-radius: 4px !important;
                line-height: 1.3 !important;
            }
            
            textarea {
                resize: none !important;
                height: 45px !important;
            }
            
            .escalation-group {
                display: grid !important;
                grid-template-columns: 1fr 1fr 1fr !important;
                gap: 10px !important;
                margin-top: 8px !important;
            }
            
            .escalation-label {
                padding: 10px 6px !important;
                font-size: 10px !important;
                text-align: center !important;
                line-height: 1.3 !important;
            }
            
            .escalation-label small {
                font-size: 9px !important;
            }
            
            /* Force page break before photos */
            .photo-section {
                page-break-before: always !important;
                margin-top: 0 !important;
                padding-top: 20px !important;
                border-top: none !important;
            }
            
            .photo-section h3 {
                font-size: 1.5em !important;
                margin-bottom: 20px !important;
                text-align: center !important;
                color: #2c3e50 !important;
            }
            
            .photo-grid {
                display: grid !important;
                grid-template-columns: 1fr 1fr !important;
                grid-template-rows: 1fr 1fr !important;
                gap: 20px !important;
            }
            
            .photo-upload {
                border: 2px solid #ddd !important;
                background: white !important;
                padding: 10px !important;
                min-height: auto !important;
                page-break-inside: avoid;
                text-align: center !important;
                border-radius: 8px !important;
            }
            
            .photo-upload:hover {
                border-color: #ddd !important;
                background: white !important;
            }
            
            .photo-preview-container {
                display: block !important;
                height: 160px !important;
                border: none !important;
                margin-bottom: 8px !important;
            }
            
            .photo-preview {
                display: block !important;
                width: 100% !important;
                height: 160px !important;
                object-fit: cover !important;
                border: 1px solid #ddd !important;
                border-radius: 6px !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            .photo-label {
                display: block !important;
                font-size: 11px !important;
                font-weight: bold !important;
                text-align: center !important;
                margin: 0 !important;
                color: #2c3e50 !important;
                line-height: 1.4 !important;
            }
            
            .upload-content, .photo-controls, .btn-group {
                display: none !important;
            }
            
            /* Prevent page breaks within form sections */
            .report-meta, .form-grid {
                page-break-inside: avoid;
            }
            
            /* Ensure form content stays on page 1 */
            .form-container > *:not(.photo-section) {
                page-break-after: avoid;
            }
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .escalation-group {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .photo-grid {
                grid-template-columns: 1fr;
            }
            
            .btn-group {
                flex-direction: column;
                align-items: center;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .form-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è LAPORAN SIAGA DEMONSTRASI</h1>
            <p>Laporan Temporer RBOC Regional V KTI</p>
        </div>

        <div class="form-container">
            <form id="securityReport">
                <div class="report-meta">
                    <div class="meta-item">
                        <div class="meta-value" id="reportTime">--:--</div>
                        <div class="meta-label">Waktu Laporan</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-value" id="reportDate">-- -- ----</div>
                        <div class="meta-label">Tanggal</div>
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="lokasi_area">üìç Lokasi Area</label>
                        <select id="lokasi_area" name="lokasi_area" required>
                            <option value="">-- Pilih Area --</option>
                            <option value="SULSELBAR">AREA SULSELBAR</option>
                            <option value="SULUT_MALUKU">AREA SULUT DAN MALUKU</option>
                            <option value="SULTENG">AREA SULTENG</option>
                            <option value="PAPUA">AREA PAPUA</option>
                            <option value="PAPUA_BARAT">AREA PAPUA BARAT</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="lokasi_gedung">üè¢ Lokasi Gedung Telkom</label>
                        <input type="text" id="lokasi_gedung" name="lokasi_gedung" required>
                    </div>

                    <div class="form-group full-width">
                        <label for="alamat">üó∫Ô∏è Alamat Lengkap</label>
                        <textarea id="alamat" name="alamat" rows="3" required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="nama_pelapor">üë§ Nama Pelapor</label>
                        <input type="text" id="nama_pelapor" name="nama_pelapor" required>
                    </div>

                    <div class="form-group">
                        <label for="jabatan">üíº Jabatan</label>
                        <input type="text" id="jabatan" name="jabatan" required>
                    </div>

                    <div class="form-group">
                        <label for="kontak">üìû Kontak</label>
                        <input type="text" id="kontak" name="kontak" required>
                    </div>

                    <div class="form-group">
                        <label for="jumlah_massa">üë• Perkiraan Jumlah Massa</label>
                        <input type="number" id="jumlah_massa" name="jumlah_massa" min="0" value="0">
                    </div>

                    <div class="form-group">
                        <label for="personil_organik">üõ°Ô∏è Jumlah Personil Organik</label>
                        <input type="number" id="personil_organik" name="personil_organik" min="0" required>
                    </div>

                    <div class="form-group">
                        <label for="pam_eksternal">üöî Jumlah PAM Eksternal/Aparat</label>
                        <input type="number" id="pam_eksternal" name="pam_eksternal" min="0" required>
                    </div>

                    <div class="form-group full-width">
                        <label>‚ö†Ô∏è Tingkat Eskalasi</label>
                        <div class="escalation-group">
                            <div class="escalation-option">
                                <input type="radio" id="hijau" name="eskalasi" value="hijau" required>
                                <label for="hijau" class="escalation-label green">üü¢ HIJAU<br><small>Kondisi Aman</small></label>
                            </div>
                            <div class="escalation-option">
                                <input type="radio" id="kuning" name="eskalasi" value="kuning">
                                <label for="kuning" class="escalation-label yellow">üü° KUNING<br><small>Waspada</small></label>
                            </div>
                            <div class="escalation-option">
                                <input type="radio" id="merah" name="eskalasi" value="merah">
                                <label for="merah" class="escalation-label red">üî¥ MERAH<br><small>Siaga Tinggi</small></label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="photo-section">
                    <h3 style="margin-bottom: 25px; color: #2c3e50;">üì∑ Dokumentasi</h3>
                    <div class="photo-grid">
                        <div class="photo-upload">
                            <div class="upload-content">
                                <div class="upload-icon">üì∏</div>
                                <h4>Foto Kondisi Gedung</h4>
                                <p>Klik untuk upload foto</p>
                            </div>
                            <div class="photo-preview-container">
                                <img id="preview1" class="photo-preview">
                                <div class="photo-controls">
                                    <button type="button" class="control-btn" onclick="event.stopPropagation(); selectImage('foto1')" title="Ganti Foto">üîÑ</button>
                                    <button type="button" class="control-btn" onclick="event.stopPropagation(); removeImage('foto1')" title="Hapus Foto">üóëÔ∏è</button>
                                </div>
                            </div>
                            <div class="photo-label">Foto Kondisi Gedung</div>
                            <input type="file" id="foto1" accept="image/*" onchange="handleImageUpload(this, 'preview1', 'Foto Kondisi Gedung')">
                        </div>

                        <div class="photo-upload">
                            <div class="upload-content">
                                <div class="upload-icon">üèôÔ∏è</div>
                                <h4>Foto Sekitar Lokasi</h4>
                                <p>Klik untuk upload foto</p>
                            </div>
                            <div class="photo-preview-container">
                                <img id="preview2" class="photo-preview">
                                <div class="photo-controls">
                                    <button type="button" class="control-btn" onclick="event.stopPropagation(); selectImage('foto2')" title="Ganti Foto">üîÑ</button>
                                    <button type="button" class="control-btn" onclick="event.stopPropagation(); removeImage('foto2')" title="Hapus Foto">üóëÔ∏è</button>
                                </div>
                            </div>
                            <div class="photo-label">Foto Sekitar Lokasi</div>
                            <input type="file" id="foto2" accept="image/*" onchange="handleImageUpload(this, 'preview2', 'Foto Sekitar Lokasi')">
                        </div>

                        <div class="photo-upload">
                            <div class="upload-content">
                                <div class="upload-icon">üëÆ</div>
                                <h4>Foto Tim Pengamanan</h4>
                                <p>Klik untuk upload foto</p>
                            </div>
                            <div class="photo-preview-container">
                                <img id="preview3" class="photo-preview">
                                <div class="photo-controls">
                                    <button type="button" class="control-btn" onclick="event.stopPropagation(); selectImage('foto3')" title="Ganti Foto">üîÑ</button>
                                    <button type="button" class="control-btn" onclick="event.stopPropagation(); removeImage('foto3')" title="Hapus Foto">üóëÔ∏è</button>
                                </div>
                            </div>
                            <div class="photo-label">Foto Tim Pengamanan</div>
                            <input type="file" id="foto3" accept="image/*" onchange="handleImageUpload(this, 'preview3', 'Foto Tim Pengamanan')">
                        </div>

                        <div class="photo-upload">
                            <div class="upload-content">
                                <div class="upload-icon">üö®</div>
                                <h4>Foto Situasi Umum</h4>
                                <p>Klik untuk upload foto</p>
                            </div>
                            <div class="photo-preview-container">
                                <img id="preview4" class="photo-preview">
                                <div class="photo-controls">
                                    <button type="button" class="control-btn" onclick="event.stopPropagation(); selectImage('foto4')" title="Ganti Foto">üîÑ</button>
                                    <button type="button" class="control-btn" onclick="event.stopPropagation(); removeImage('foto4')" title="Hapus Foto">üóëÔ∏è</button>
                                </div>
                            </div>
                            <div class="photo-label">Foto Situasi Umum</div>
                            <input type="file" id="foto4" accept="image/*" onchange="handleImageUpload(this, 'preview4', 'Foto Situasi Umum')">
                        </div>
                    </div>
                </div>

                <div class="submit-section">
                    <div class="btn-group">
                        <button type="button" class="btn btn-success" onclick="generatePDF()">
                            üìÑ Generate PDF
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script>
        let processedImages = {};

        // Update waktu real-time
        function updateTime() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('id-ID');
            const dateStr = now.toLocaleDateString('id-ID', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            document.getElementById('reportTime').textContent = timeStr;
            document.getElementById('reportDate').textContent = dateStr;
        }

        setInterval(updateTime, 1000);
        updateTime();

        // Initialize photo upload events after DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            setupPhotoUploadEvents();
        });

        // Also run setup immediately in case DOM is already loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', setupPhotoUploadEvents);
        } else {
            setupPhotoUploadEvents();
        }

        function selectImage(inputId) {
            // Force click on mobile devices
            const input = document.getElementById(inputId);
            if (input) {
                input.click();
            }
        }

        // Add touch event handlers for better mobile support
        function setupPhotoUploadEvents() {
            const photoUploads = document.querySelectorAll('.photo-upload');
            
            photoUploads.forEach(upload => {
                // Get the input ID from the onclick attribute or find the input inside
                const input = upload.querySelector('input[type="file"]');
                if (input) {
                    // Remove onclick and add proper event listeners
                    upload.removeAttribute('onclick');
                    
                    // Add click handler
                    upload.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        input.click();
                    });
                    
                    // Add touch handlers for iOS
                    upload.addEventListener('touchstart', function(e) {
                        e.preventDefault();
                    });
                    
                    upload.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        input.click();
                    });
                    
                    // Make sure it's focusable for iOS
                    upload.setAttribute('tabindex', '0');
                    upload.style.cursor = 'pointer';
                    upload.style.webkitTapHighlightColor = 'rgba(0,0,0,0.1)';
                }
            });
        }

        function handleImageUpload(input, previewId, photoTitle) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    processAndDisplayImage(img, previewId);
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function processAndDisplayImage(img, previewId) {
            // Create canvas for processing
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            // Set uniform size (300x300 square)
            const uniformSize = 300;
            canvas.width = uniformSize;
            canvas.height = uniformSize;

            // Fill background
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 0, uniformSize, uniformSize);
            
            // Calculate dimensions to fit image while maintaining aspect ratio
            const aspectRatio = img.width / img.height;
            let drawWidth = uniformSize;
            let drawHeight = uniformSize;
            let offsetX = 0;
            let offsetY = 0;

            if (aspectRatio > 1) {
                // Landscape: fit height, center horizontally
                drawHeight = uniformSize;
                drawWidth = uniformSize * aspectRatio;
                offsetX = (uniformSize - drawWidth) / 2;
            } else {
                // Portrait or square: fit width, center vertically
                drawWidth = uniformSize;
                drawHeight = uniformSize / aspectRatio;
                offsetY = (uniformSize - drawHeight) / 2;
            }

            // Draw image centered and scaled
            ctx.drawImage(img, offsetX, offsetY, drawWidth, drawHeight);

            // Convert to data URL and display
            const dataURL = canvas.toDataURL('image/jpeg', 0.9);
            const preview = document.getElementById(previewId);
            const container = preview.parentElement;
            const uploadDiv = container.parentElement;
            
            preview.src = dataURL;
            container.style.display = 'block';
            uploadDiv.classList.add('has-image');
            
            // Store processed image
            processedImages[previewId] = dataURL;
        }

        function removeImage(inputId) {
            const input = document.getElementById(inputId);
            const previewId = inputId.replace('foto', 'preview');
            const preview = document.getElementById(previewId);
            const container = preview.parentElement;
            const uploadDiv = container.parentElement;
            
            // Clear input and preview
            input.value = '';
            preview.src = '';
            container.style.display = 'none';
            uploadDiv.classList.remove('has-image');
            
            // Remove stored data
            delete processedImages[previewId];
        }

        // Generate PDF
        function generatePDF() {
            // Validasi form sebelum generate PDF
            const form = document.getElementById('securityReport');
            const requiredFields = form.querySelectorAll('[required]');
            let isValid = true;
            
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    isValid = false;
                    field.style.borderColor = '#dc3545';
                } else {
                    field.style.borderColor = '#28a745';
                }
            });
            
            if (!isValid) {
                alert('‚ö†Ô∏è Mohon lengkapi semua field yang wajib diisi sebelum generate PDF!');
                return;
            }
            
            // Prepare images for printing
            const photoLabels = {
                'preview1': 'Foto Kondisi Gedung',
                'preview2': 'Foto Sekitar Lokasi', 
                'preview3': 'Foto Tim Pengamanan',
                'preview4': 'Foto Situasi Umum'
            };

            Object.keys(photoLabels).forEach(previewId => {
                const preview = document.getElementById(previewId);
                const container = preview.parentElement;
                
                if (preview.src && container.style.display !== 'none') {
                    // Ensure image is visible and properly sized for print
                    container.style.display = 'block';
                    preview.style.display = 'block';
                    preview.style.width = '100%';
                    preview.style.height = '250px';
                    preview.style.objectFit = 'cover';
                    preview.style.border = '1px solid #ddd';
                    preview.style.borderRadius = '5px';
                    
                    // Add or update label
                    let label = container.parentElement.querySelector('.photo-label');
                    if (label) {
                        label.style.display = 'block';
                        label.style.fontWeight = 'bold';
                        label.style.marginBottom = '10px';
                        label.style.fontSize = '14px';
                        label.style.color = '#333';
                    }
                }
            });
            
            // Hide buttons during print
            const buttons = document.querySelector('.submit-section');
            buttons.style.display = 'none';
            
            // Print
            setTimeout(() => {
                window.print();
                
                // Restore UI after print
                setTimeout(() => {
                    buttons.style.display = 'block';
                }, 1000);
            }, 100);
        }
    </script>
</body>
</html>